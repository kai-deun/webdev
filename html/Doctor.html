<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VitalSoft - Doctor Dashboard</title>
    <link rel="stylesheet" href="../css/doctor.css" />
  </head>
  <body>
    <script src="../js/common.js"></script>
    <!-- top bar with app title and logged-in user -->
    <header>
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <i class="fas fa-user-md"></i>
            <h1>VitalSoft - Doctor Portal</h1>
          </div>
          <div class="user-info">
            <div class="user-avatar">--</div>
            <div>
              <div class="user-name">Loading...</div>
              <div class="user-role">Doctor</div>
            </div>
            <button class="btn btn-logout" onclick="handleLogout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <div class="dashboard">
        <div class="main-content">
          <!-- title and quick action buttons -->
          <div class="content-header">
            <h2>Doctor Dashboard</h2>
            <div class="header-actions">
              <button id="btn-new-prescription" class="btn btn-primary">
                <i class="fas fa-plus"></i> New Prescription
              </button>
              <button id="btn-add-patient" class="btn btn-primary">
                <i class="fas fa-user-plus"></i> Add Patient
              </button>
            </div>
            <!-- A-Z filter removed; search bar will be used for filtering -->
          </div>

          <!-- small cards showing counts (patients, prescriptions, consultations, pending requests) -->
          <div class="stats-cards">
            <div class="stat-card">
              <i class="fas fa-users"></i>
              <h3>Active Patients</h3>
              <div class="value" id="patients-today-stat">0</div>
            </div>
            <div class="stat-card">
              <i class="fas fa-prescription-bottle"></i>
              <h3>Active Prescriptions</h3>
              <div class="value" id="prescriptions-today-stat">0</div>
            </div>
            <div class="stat-card">
              <i class="fas fa-clock"></i>
              <h3>Pending Renewals</h3>
              <div class="value" id="appointments-stat">0</div>
            </div>
          </div>
          </div>

          <!-- switch between Patients and Prescriptions views -->
          <div class="content-tabs">
            <button class="tab-btn active" data-tab="patients">Patients</button>
            <button class="tab-btn" data-tab="prescriptions">
              Prescriptions
            </button>
            <button class="tab-btn" data-tab="renewals">
              Renewal Requests
            </button>
          </div>

          <!-- searchable list with table layout -->
          <div class="tab-content active" id="patients-tab">
            <div class="search-filter">
              <input
                type="text"
                class="search-box"
                placeholder="Search patients..."
              />
              <button class="btn btn-primary">
                <i class="fas fa-search"></i> Search
              </button>
            </div>

            <div class="table-container">
              <table class="data-table" id="patients-table">
                <thead>
                  <tr>
                    <th>Patient ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Age</th>
                    <th>Gender</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Patients will be populated from database -->
                </tbody>
              </table>
              <div class="loading" id="patients-loading" style="display:none;">Loading...</div>
            </div>
          </div>

          <!-- searchable and filterable table with batch scroll -->
          <div class="tab-content" id="prescriptions-tab">
            <div class="search-filter">
              <input
                type="text"
                class="search-box"
                placeholder="Search prescriptions..."
              />
              <select class="filter-select">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="expired">Expired</option>
                <option value="cancelled">Cancelled</option>
              </select>
            </div>

            <div class="table-container">
              <table class="data-table" id="prescriptions-table">
                <thead>
                  <tr>
                    <th>Prescription ID</th>
                    <th>Date</th>
                    <th>Patient</th>
                    <th>Diagnosis</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Prescriptions will be populated from database -->
                </tbody>
              </table>
              <div class="loading" id="prescriptions-loading" style="display:none;">Loading...</div>
            </div>
          </div>

          <!-- renewal approvals tab -->
          <div class="tab-content" id="renewals-tab">
            <div class="renewals-header" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;">
              <div>
                <h3 style="margin:0;color:#2c3e50;font-size:18px;">Prescription Renewal Requests</h3>
                <p style="color:#666;font-size:14px;margin:5px 0 0 0;">Review and manage patient renewal requests</p>
              </div>
              <div class="renewals-badge" style="background:#3498db;color:white;padding:8px 16px;border-radius:20px;font-weight:600;font-size:14px;">
                <i class="fas fa-list"></i> <span id="renewals-count">0</span> Requests
              </div>
            </div>
            
            <div class="search-filter">
              <input type="text" class="search-box" id="renewals-search" placeholder="Search by patient name, prescription ID...">
              <select class="filter-select" id="renewals-status-filter">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
              </select>
            </div>

            <div class="table-container">
              <table class="data-table" id="renewals-table">
                <thead>
                  <tr>
                    <th>Renewal ID</th>
                    <th>Patient Name</th>
                    <th>Prescription ID</th>
                    <th>Request Date</th>
                    <th>Patient Notes</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td colspan="7" class="text-center" style="padding:40px;color:#666;">
                    <i class="fas fa-spinner fa-spin" style="font-size:24px;margin-bottom:10px;"></i>
                    <p>Loading renewal requests...</p>
                  </td></tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- select patient, add medicines, save prescription -->
          <div class="content-section">
            <h3>Create New Prescription</h3>
            <div class="form-container">
              <div class="form-row">
                <div class="form-group">
                  <label for="patient-select">Select Patient</label>
                    <select id="patient-select" class="form-control">
                    <option value="">Choose a patient...</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="prescription-date">Prescription Date</label>
                  <input
                    type="date"
                    id="prescription-date"
                    class="form-control"
                  />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="diagnosis">Diagnosis</label>
                  <input
                    type="text"
                    id="diagnosis"
                    class="form-control"
                    placeholder="Enter diagnosis"
                  />
                </div>
                <div class="form-group">
                  <label for="notes">Notes</label>
                  <input
                    type="text"
                    id="notes"
                    class="form-control"
                    placeholder="Additional notes"
                  />
                </div>
              </div>

              <div class="medicine-form">
                <h4>Add Medicine</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label for="medicine-name">Medicine Name</label>
                    <input
                      type="text"
                      id="medicine-name"
                      class="form-control"
                      placeholder="Enter medicine name"
                    />
                  </div>
                  <div class="form-group">
                    <label for="medicine-dosage">Dosage</label>
                    <input
                      type="text"
                      id="medicine-dosage"
                      class="form-control"
                      placeholder="e.g., 500mg"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="medicine-quantity">Quantity</label>
                    <input
                      type="number"
                      id="medicine-quantity"
                      class="form-control"
                      placeholder="Number of units"
                      min="1"
                    />
                  </div>
                  <div class="form-group">
                    <label for="medicine-instructions">Instructions</label>
                    <input
                      type="text"
                      id="medicine-instructions"
                      class="form-control"
                      placeholder="Usage instructions"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="dosage-frequency">Dosage Frequency</label>
                    <select id="dosage-frequency" class="form-control">
                      <option value="Once daily">Once daily</option>
                      <option value="Twice daily">Twice daily</option>
                      <option value="Three times daily">Three times daily</option>
                      <option value="Four times daily">Four times daily</option>
                      <option value="Every 6 hours">Every 6 hours</option>
                      <option value="Every 8 hours">Every 8 hours</option>
                      <option value="Every 12 hours">Every 12 hours</option>
                      <option value="As needed">As needed</option>
                      <option value="As directed">As directed</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="duration-days">Duration (Days)</label>
                    <input
                      type="number"
                      id="duration-days"
                      class="form-control"
                      placeholder="Number of days"
                      min="1"
                      value="7"
                    />
                  </div>
                </div>
                <button class="btn btn-secondary">
                  <i class="fas fa-plus"></i> Add Medicine
                </button>
              </div>

              <div class="form-actions">
                <button class="btn btn-success" id="save-prescription">
                  <i class="fas fa-save"></i> Save Prescription
                </button>
                <button class="btn btn-secondary">Cancel</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/common.js"></script>
    <script src="../js/PrescriptionManager.js" type="module"></script>
  </body>
</html>